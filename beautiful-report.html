
🏥 [34m[1mDATABASE HEALTH AUDIT REPORT[22m[39m
═══════════════════════════════════════════════════════════════


🗂️  [1mDATABASE INFORMATION[22m
────────────────────────────────────────────────────────────────

📊 Database Size: [36m17 MB[39m
📋 Tables: [33m45[39m
📈 Indexes: [33m117[39m
🔗 Connections: [32m1[39m/100

⚙️  Configuration:
  • Shared Buffers: 16384 8kB
  • Effective Cache Size: 524288 8kB
  • Work Memory: 4096 kB
  • Maintenance Work Memory: 65536 kB


🏗️  [1mSCHEMA HEALTH ANALYSIS[22m
────────────────────────────────────────────────────────────────

📊 Overall Health Score: [31m3/10[39m

🔍 Component Scores:
  • Normalization: [32m8/10[39m
  • Index Efficiency: [31m0/10[39m
  • Foreign Key Integrity: [32m8/10[39m
  • Data Types: [31m0/10[39m
  • Naming: [32m9/10[39m

⚠️  [1mSCHEMA ISSUES FOUND:[22m

  [31m[1m●[22m[39m [31m[1mCRITICAL[22m[39m - Table 'user_recommendations' has no primary key
    💡 Add a primary key to ensure data integrity and better performance
    🔧 [90mALTER TABLE user_recommendations ADD COLUMN id SERIAL PRIMARY KEY;[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'hms_broadcast_template_id' in table 'broadcasts' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_broadcasts_hms_broadcast_template_id ON broadcasts(hms_broadcast_template_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'recording_id' in table 'broadcasts' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_broadcasts_recording_id ON broadcasts(recording_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'thumbnail_id' in table 'broadcasts' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_broadcasts_thumbnail_id ON broadcasts(thumbnail_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'team' in table 'user_broadcast_details' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_user_broadcast_details_team ON user_broadcast_details(team);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'user_id' in table 'audit_logs' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_audit_logs_user_id ON audit_logs(user_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'last_blocked_by' in table 'users' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_users_last_blocked_by ON users(last_blocked_by);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'created_by' in table 'roles' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_roles_created_by ON roles(created_by);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'user_id' in table 'file_metadatas' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_file_metadatas_user_id ON file_metadatas(user_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'avatar' in table 'users' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_users_avatar ON users(avatar);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'cover_image' in table 'users' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_users_cover_image ON users(cover_image);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'user_id' in table 'user_blocked_reasons' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_user_blocked_reasons_user_id ON user_blocked_reasons(user_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'last_blocked_by' in table 'user_blocked_reasons' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_user_blocked_reasons_last_blocked_by ON user_blocked_reasons(last_blocked_by);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'assigned_by' in table 'user_roles' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_user_roles_assigned_by ON user_roles(assigned_by);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'module_id' in table 'permissions' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_permissions_module_id ON permissions(module_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'assigned_by' in table 'user_permissions' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_user_permissions_assigned_by ON user_permissions(assigned_by);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'team' in table 'broadcast_votes' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_broadcast_votes_team ON broadcast_votes(team);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'broadcast_id' in table 'evidence_board' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_evidence_board_broadcast_id ON evidence_board(broadcast_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'user_id' in table 'evidence_board' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_evidence_board_user_id ON evidence_board(user_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'evidence_hidden_by' in table 'evidence_board' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_evidence_board_evidence_hidden_by ON evidence_board(evidence_hidden_by);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'evidence_id' in table 'evidence_files' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_evidence_files_evidence_id ON evidence_files(evidence_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'file_id' in table 'evidence_files' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_evidence_files_file_id ON evidence_files(file_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'broadcast_id' in table 'comments' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_comments_broadcast_id ON comments(broadcast_id);[39m

  [31m●[39m [31mHIGH[39m - Foreign key 'user_id' in table 'comments' is not indexed
    💡 Create an index on foreign key columns for better JOIN performance
    🔧 [90mCREATE INDEX idx_comments_user_id ON comments(user_id);[39m

  [33m●[39m [33mMEDIUM[39m - Column 'logs' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'reason' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'primary_website' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'secondary_website' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'linkedin_page' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'facebook_page' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'instagram_page' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'intro_video' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'x_page' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'tik_tok_page' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'youtube_page' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'pinterest_page' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'short_bio' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'long_bio' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'description' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'token' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'description' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'description' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'reason' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'description' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'description' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'error_message' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'evidence_content' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'evidence_hidden_reason' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'description' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'description' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'icon_url' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'description' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'push_notification_token' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'reason' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'content' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'reason' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'reason' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'chat_message' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'reason' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'message' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'error_log' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'requested_api' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'user_agent' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'description' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'reason' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance

  [33m●[39m [33mMEDIUM[39m - Column 'reason' uses inefficient data type 'text'
    💡 Consider using more specific data types for better performance


📈 [1mINDEX ANALYSIS[22m
────────────────────────────────────────────────────────────────

📊 Total Indexes: [33m117[39m
⚡ Index Efficiency Score: [31m0/10[39m

🗑️  [1mUNUSED INDEXES:[22m
  • [31musers_pkey[39m on users (16 kB)
  • [31musers_username_key[39m on users (16 kB)
  • [31mdelete_reasons_pkey[39m on delete_reasons (8192 bytes)
  • [31munique_user_id[39m on delete_reasons (8192 bytes)
  • [31minstitutions_pkey[39m on institutions (312 kB)
  • [31muser_education_institutions_pkey[39m on user_education_institutions (8192 bytes)
  • [31munique_user_institution[39m on user_education_institutions (8192 bytes)
  • [31mfile_metadatas_pkey[39m on file_metadatas (8192 bytes)
  • [31moauth_identities_pkey[39m on oauth_identities (8192 bytes)
  • [31munique_user_id_provider_name[39m on oauth_identities (8192 bytes)
  • [31muser_devices_pkey[39m on user_devices (8192 bytes)
  • [31muser_blocked_reasons_pkey[39m on user_blocked_reasons (8192 bytes)
  • [31munique_user_device[39m on user_devices (8192 bytes)
  • [31muser_otps_pkey[39m on user_otps (8192 bytes)
  • [31munique_user_id_otp_type[39m on user_otps (8192 bytes)
  • [31muser_permissions_pkey[39m on user_permissions (8192 bytes)
  • [31mcategories_name_key[39m on categories (16 kB)
  • [31mcategories_slug_key[39m on categories (16 kB)
  • [31msub_categories_name_key[39m on sub_categories (16 kB)
  • [31msub_categories_slug_key[39m on sub_categories (16 kB)
  • [31munique_topic_name[39m on topics (280 kB)
  • [31munique_topic_slug[39m on topics (280 kB)
  • [31midx_category_name[39m on categories (16 kB)
  • [31midx_subcategory_name[39m on sub_categories (16 kB)
  • [31midx_topic_name[39m on topics (280 kB)
  • [31midx_category_subcategories[39m on category_sub_categories (16 kB)
  • [31midx_subcategory_topics[39m on sub_category_topics (344 kB)
  • [31midx_user_email[39m on users (16 kB)
  • [31midx_user_username[39m on users (16 kB)
  • [31midx_user_relationships_follower[39m on user_relationships (16 kB)
  • [31midx_user_blocks_blocker[39m on user_blocks (16 kB)
  • [31midx_user_blocks_blocked[39m on user_blocks (16 kB)
  • [31midx_user_blocks_both[39m on user_blocks (16 kB)
  • [31mteams_name_key[39m on teams (16 kB)
  • [31mbroadcasts_pkey[39m on broadcasts (8192 bytes)
  • [31mbroadcasts_room_id_key[39m on broadcasts (8192 bytes)
  • [31munique_invite_code[39m on broadcasts (8192 bytes)
  • [31midx_broadcasts_title[39m on broadcasts (8192 bytes)
  • [31midx_broadcasts_room_id[39m on broadcasts (8192 bytes)
  • [31midx_broadcasts_sub_category_id[39m on broadcasts (8192 bytes)
  • [31midx_broadcasts_category_id[39m on broadcasts (8192 bytes)
  • [31mbroadcast_likes_pkey[39m on broadcast_likes (8192 bytes)
  • [31munique_broadcast_like[39m on broadcast_likes (8192 bytes)
  • [31mbroadcast_peers_details_pkey[39m on broadcast_peers_details (8192 bytes)
  • [31munique_broadcast_peer[39m on broadcast_peers_details (8192 bytes)
  • [31muser_broadcast_details_pkey[39m on user_broadcast_details (8192 bytes)
  • [31munique_user_broadcast[39m on user_broadcast_details (8192 bytes)
  • [31midx_user_broadcast_details_user_id[39m on user_broadcast_details (8192 bytes)
  • [31midx_user_broadcast_details_broadcast_id[39m on user_broadcast_details (8192 bytes)
  • [31mbroadcast_latest_votes_pkey[39m on broadcast_latest_votes (8192 bytes)
  • [31munique_broadcast_latest_vote[39m on broadcast_latest_votes (8192 bytes)
  • [31midx_broadcast_latest_votes_broadcast_id[39m on broadcast_latest_votes (8192 bytes)
  • [31midx_broadcast_latest_votes_user_id[39m on broadcast_latest_votes (8192 bytes)
  • [31midx_broadcast_latest_votes_team[39m on broadcast_latest_votes (8192 bytes)
  • [31mbroadcast_votes_pkey[39m on broadcast_votes (8192 bytes)
  • [31midx_broadcast_votes_broadcast_id[39m on broadcast_votes (8192 bytes)
  • [31midx_broadcast_votes_user_id[39m on broadcast_votes (8192 bytes)
  • [31mevidence_board_pkey[39m on evidence_board (8192 bytes)
  • [31mevidence_files_pkey[39m on evidence_files (8192 bytes)
  • [31mhms_webhook_events_pkey[39m on hms_webhook_events (8192 bytes)
  • [31mcomments_pkey[39m on comments (8192 bytes)
  • [31mevidence_reports_pkey[39m on evidence_reports (8192 bytes)
  • [31munique_evidence_report[39m on evidence_reports (8192 bytes)
  • [31mviewer_reports_pkey[39m on viewer_reports (8192 bytes)
  • [31munique_viewer_report[39m on viewer_reports (8192 bytes)
  • [31midx_institutions_name[39m on institutions (536 kB)
  • [31mbroadcast_hidden_reasons_pkey[39m on broadcast_hidden_reasons (8192 bytes)
  • [31munique_broadcast_hidden_reason[39m on broadcast_hidden_reasons (8192 bytes)
  • [31mnotifications_pkey[39m on notifications (8192 bytes)
  • [31midx_notifications_user_id[39m on notifications (8192 bytes)
  • [31midx_notifications_type[39m on notifications (8192 bytes)
  • [31midx_notifications_status[39m on notifications (8192 bytes)
  • [31midx_notifications_created_at[39m on notifications (8192 bytes)
  • [31maudit_logs_pkey[39m on audit_logs (8192 bytes)
  • [31muser_relationship_status_pkey[39m on user_relationship_status (8192 bytes)
  • [31mbroadcast_reports_pkey[39m on broadcast_reports (8192 bytes)
  • [31munique_broadcast_report[39m on broadcast_reports (8192 bytes)
  • [31midx_broadcast_reports_broadcast_id[39m on broadcast_reports (8192 bytes)
  • [31midx_broadcast_reports_user_id[39m on broadcast_reports (8192 bytes)
  • [31midx_broadcasts_is_reported[39m on broadcasts (8192 bytes)
  • [31midx_broadcasts_report_count[39m on broadcasts (8192 bytes)
  • [31muser_reports_pkey[39m on user_reports (8192 bytes)
  • [31munique_user_report[39m on user_reports (8192 bytes)
  • [31midx_user_reports_reported_user_id[39m on user_reports (8192 bytes)
  • [31midx_user_reports_reporter_id[39m on user_reports (8192 bytes)
  • [31midx_broadcasts_is_expired[39m on broadcasts (8192 bytes)


⚡ [1mPERFORMANCE ANALYSIS[22m
────────────────────────────────────────────────────────────────

🚨 [1mPERFORMANCE ISSUES:[22m

  [33m●[39m [33mMEDIUM[39m - Table 'teams' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE teams;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'roles' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE roles;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_devices' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_devices;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_relationship_status' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_relationship_status;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'hms_broadcast_templates' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE hms_broadcast_templates;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'broadcasts' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE broadcasts;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'users' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE users;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_education_institutions' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_education_institutions;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'modules' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE modules;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'broadcast_hidden_reasons' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE broadcast_hidden_reasons;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_roles' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_roles;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'hms_webhook_events' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE hms_webhook_events;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'comments' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE comments;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'broadcast_votes' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE broadcast_votes;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'oauth_identities' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE oauth_identities;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_topics' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_topics;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_blocked_reasons' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_blocked_reasons;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'notifications' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE notifications;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'broadcast_reports' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE broadcast_reports;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_blocks' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_blocks;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'categories' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE categories;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_broadcast_details' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_broadcast_details;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'evidence_board' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE evidence_board;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'viewer_reports' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE viewer_reports;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'delete_reasons' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE delete_reasons;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'category_sub_categories' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE category_sub_categories;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'broadcast_peers_details' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE broadcast_peers_details;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'evidence_files' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE evidence_files;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_permissions' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_permissions;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'file_metadatas' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE file_metadatas;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'sub_category_topics' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE sub_category_topics;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'role_permissions' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE role_permissions;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'institutions' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE institutions;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_otps' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_otps;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'permissions' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE permissions;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'evidence_reports' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE evidence_reports;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'audit_logs' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE audit_logs;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_relationships' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_relationships;[39m

  [33m●[39m [33mMEDIUM[39m - Table '_prisma_migrations' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE _prisma_migrations;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_recommendations' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_recommendations;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'topics' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE topics;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'sub_categories' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE sub_categories;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'user_reports' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE user_reports;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'broadcast_latest_votes' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE broadcast_latest_votes;[39m

  [33m●[39m [33mMEDIUM[39m - Table 'broadcast_likes' has outdated statistics
    📊 Impact: Query planner may make suboptimal decisions
    💡 Solution: Run ANALYZE to update table statistics
    🔧 [90mANALYZE broadcast_likes;[39m


🔒 [1mSECURITY ANALYSIS[22m
────────────────────────────────────────────────────────────────

[32m✅ No critical security issues detected![39m


💰 [1mCOST ANALYSIS[22m
────────────────────────────────────────────────────────────────

📊 Storage Usage:
  • Total Size: [36m17 MB[39m
  • Data Size: [36m13.01 MB[39m
  • Index Size: [36m4264 kB[39m
  • Wasted Space: [31m0 bytes[39m

💵 Estimated Monthly Costs:
  • Storage: $0.00
  • Compute: $50.00
  • Maintenance: $20.00
  • Total: $70.00


💡 [1mOPTIMIZATION RECOMMENDATIONS[22m
────────────────────────────────────────────────────────────────


1. [1mImprove Schema Design[22m [[31mHIGH[39m]
   📝 Schema health score is below recommended threshold
   📊 Impact: High - Better query performance and data integrity
   🛠️  Implementation: Address missing primary keys and foreign key indexes
   🔧 SQL Commands:
      [90mALTER TABLE user_recommendations ADD COLUMN id SERIAL PRIMARY KEY;[39m
      [90mCREATE INDEX idx_broadcasts_hms_broadcast_template_id ON broadcasts(hms_broadcast_template_id);[39m
      [90mCREATE INDEX idx_broadcasts_recording_id ON broadcasts(recording_id);[39m
      [90mCREATE INDEX idx_broadcasts_thumbnail_id ON broadcasts(thumbnail_id);[39m
      [90mCREATE INDEX idx_user_broadcast_details_team ON user_broadcast_details(team);[39m
      [90mCREATE INDEX idx_audit_logs_user_id ON audit_logs(user_id);[39m
      [90mCREATE INDEX idx_users_last_blocked_by ON users(last_blocked_by);[39m
      [90mCREATE INDEX idx_roles_created_by ON roles(created_by);[39m
      [90mCREATE INDEX idx_file_metadatas_user_id ON file_metadatas(user_id);[39m
      [90mCREATE INDEX idx_users_avatar ON users(avatar);[39m
      [90mCREATE INDEX idx_users_cover_image ON users(cover_image);[39m
      [90mCREATE INDEX idx_user_blocked_reasons_user_id ON user_blocked_reasons(user_id);[39m
      [90mCREATE INDEX idx_user_blocked_reasons_last_blocked_by ON user_blocked_reasons(last_blocked_by);[39m
      [90mCREATE INDEX idx_user_roles_assigned_by ON user_roles(assigned_by);[39m
      [90mCREATE INDEX idx_permissions_module_id ON permissions(module_id);[39m
      [90mCREATE INDEX idx_user_permissions_assigned_by ON user_permissions(assigned_by);[39m
      [90mCREATE INDEX idx_broadcast_votes_team ON broadcast_votes(team);[39m
      [90mCREATE INDEX idx_evidence_board_broadcast_id ON evidence_board(broadcast_id);[39m
      [90mCREATE INDEX idx_evidence_board_user_id ON evidence_board(user_id);[39m
      [90mCREATE INDEX idx_evidence_board_evidence_hidden_by ON evidence_board(evidence_hidden_by);[39m
      [90mCREATE INDEX idx_evidence_files_evidence_id ON evidence_files(evidence_id);[39m
      [90mCREATE INDEX idx_evidence_files_file_id ON evidence_files(file_id);[39m
      [90mCREATE INDEX idx_comments_broadcast_id ON comments(broadcast_id);[39m
      [90mCREATE INDEX idx_comments_user_id ON comments(user_id);[39m

2. [1mRemove Unused Indexes[22m [[33mMEDIUM[39m]
   📝 Found 86 unused indexes
   📊 Impact: Medium - Reduced storage costs and faster writes
   🛠️  Implementation: Drop unused indexes after confirming they are not needed
   🔧 SQL Commands:
      [90mDROP INDEX users_pkey;[39m
      [90mDROP INDEX users_username_key;[39m
      [90mDROP INDEX delete_reasons_pkey;[39m
      [90mDROP INDEX unique_user_id;[39m
      [90mDROP INDEX institutions_pkey;[39m
      [90mDROP INDEX user_education_institutions_pkey;[39m
      [90mDROP INDEX unique_user_institution;[39m
      [90mDROP INDEX file_metadatas_pkey;[39m
      [90mDROP INDEX oauth_identities_pkey;[39m
      [90mDROP INDEX unique_user_id_provider_name;[39m
      [90mDROP INDEX user_devices_pkey;[39m
      [90mDROP INDEX user_blocked_reasons_pkey;[39m
      [90mDROP INDEX unique_user_device;[39m
      [90mDROP INDEX user_otps_pkey;[39m
      [90mDROP INDEX unique_user_id_otp_type;[39m
      [90mDROP INDEX user_permissions_pkey;[39m
      [90mDROP INDEX categories_name_key;[39m
      [90mDROP INDEX categories_slug_key;[39m
      [90mDROP INDEX sub_categories_name_key;[39m
      [90mDROP INDEX sub_categories_slug_key;[39m
      [90mDROP INDEX unique_topic_name;[39m
      [90mDROP INDEX unique_topic_slug;[39m
      [90mDROP INDEX idx_category_name;[39m
      [90mDROP INDEX idx_subcategory_name;[39m
      [90mDROP INDEX idx_topic_name;[39m
      [90mDROP INDEX idx_category_subcategories;[39m
      [90mDROP INDEX idx_subcategory_topics;[39m
      [90mDROP INDEX idx_user_email;[39m
      [90mDROP INDEX idx_user_username;[39m
      [90mDROP INDEX idx_user_relationships_follower;[39m
      [90mDROP INDEX idx_user_blocks_blocker;[39m
      [90mDROP INDEX idx_user_blocks_blocked;[39m
      [90mDROP INDEX idx_user_blocks_both;[39m
      [90mDROP INDEX teams_name_key;[39m
      [90mDROP INDEX broadcasts_pkey;[39m
      [90mDROP INDEX broadcasts_room_id_key;[39m
      [90mDROP INDEX unique_invite_code;[39m
      [90mDROP INDEX idx_broadcasts_title;[39m
      [90mDROP INDEX idx_broadcasts_room_id;[39m
      [90mDROP INDEX idx_broadcasts_sub_category_id;[39m
      [90mDROP INDEX idx_broadcasts_category_id;[39m
      [90mDROP INDEX broadcast_likes_pkey;[39m
      [90mDROP INDEX unique_broadcast_like;[39m
      [90mDROP INDEX broadcast_peers_details_pkey;[39m
      [90mDROP INDEX unique_broadcast_peer;[39m
      [90mDROP INDEX user_broadcast_details_pkey;[39m
      [90mDROP INDEX unique_user_broadcast;[39m
      [90mDROP INDEX idx_user_broadcast_details_user_id;[39m
      [90mDROP INDEX idx_user_broadcast_details_broadcast_id;[39m
      [90mDROP INDEX broadcast_latest_votes_pkey;[39m
      [90mDROP INDEX unique_broadcast_latest_vote;[39m
      [90mDROP INDEX idx_broadcast_latest_votes_broadcast_id;[39m
      [90mDROP INDEX idx_broadcast_latest_votes_user_id;[39m
      [90mDROP INDEX idx_broadcast_latest_votes_team;[39m
      [90mDROP INDEX broadcast_votes_pkey;[39m
      [90mDROP INDEX idx_broadcast_votes_broadcast_id;[39m
      [90mDROP INDEX idx_broadcast_votes_user_id;[39m
      [90mDROP INDEX evidence_board_pkey;[39m
      [90mDROP INDEX evidence_files_pkey;[39m
      [90mDROP INDEX hms_webhook_events_pkey;[39m
      [90mDROP INDEX comments_pkey;[39m
      [90mDROP INDEX evidence_reports_pkey;[39m
      [90mDROP INDEX unique_evidence_report;[39m
      [90mDROP INDEX viewer_reports_pkey;[39m
      [90mDROP INDEX unique_viewer_report;[39m
      [90mDROP INDEX idx_institutions_name;[39m
      [90mDROP INDEX broadcast_hidden_reasons_pkey;[39m
      [90mDROP INDEX unique_broadcast_hidden_reason;[39m
      [90mDROP INDEX notifications_pkey;[39m
      [90mDROP INDEX idx_notifications_user_id;[39m
      [90mDROP INDEX idx_notifications_type;[39m
      [90mDROP INDEX idx_notifications_status;[39m
      [90mDROP INDEX idx_notifications_created_at;[39m
      [90mDROP INDEX audit_logs_pkey;[39m
      [90mDROP INDEX user_relationship_status_pkey;[39m
      [90mDROP INDEX broadcast_reports_pkey;[39m
      [90mDROP INDEX unique_broadcast_report;[39m
      [90mDROP INDEX idx_broadcast_reports_broadcast_id;[39m
      [90mDROP INDEX idx_broadcast_reports_user_id;[39m
      [90mDROP INDEX idx_broadcasts_is_reported;[39m
      [90mDROP INDEX idx_broadcasts_report_count;[39m
      [90mDROP INDEX user_reports_pkey;[39m
      [90mDROP INDEX unique_user_report;[39m
      [90mDROP INDEX idx_user_reports_reported_user_id;[39m
      [90mDROP INDEX idx_user_reports_reporter_id;[39m
      [90mDROP INDEX idx_broadcasts_is_expired;[39m

3. [1mAddress Performance Issues[22m [[31mHIGH[39m]
   📝 Found 45 performance issues
   📊 Impact: High - Improved query response times
   🛠️  Implementation: Run maintenance commands and optimize queries
   🔧 SQL Commands:
      [90mANALYZE teams;[39m
      [90mANALYZE roles;[39m
      [90mANALYZE user_devices;[39m
      [90mANALYZE user_relationship_status;[39m
      [90mANALYZE hms_broadcast_templates;[39m
      [90mANALYZE broadcasts;[39m
      [90mANALYZE users;[39m
      [90mANALYZE user_education_institutions;[39m
      [90mANALYZE modules;[39m
      [90mANALYZE broadcast_hidden_reasons;[39m
      [90mANALYZE user_roles;[39m
      [90mANALYZE hms_webhook_events;[39m
      [90mANALYZE comments;[39m
      [90mANALYZE broadcast_votes;[39m
      [90mANALYZE oauth_identities;[39m
      [90mANALYZE user_topics;[39m
      [90mANALYZE user_blocked_reasons;[39m
      [90mANALYZE notifications;[39m
      [90mANALYZE broadcast_reports;[39m
      [90mANALYZE user_blocks;[39m
      [90mANALYZE categories;[39m
      [90mANALYZE user_broadcast_details;[39m
      [90mANALYZE evidence_board;[39m
      [90mANALYZE viewer_reports;[39m
      [90mANALYZE delete_reasons;[39m
      [90mANALYZE category_sub_categories;[39m
      [90mANALYZE broadcast_peers_details;[39m
      [90mANALYZE evidence_files;[39m
      [90mANALYZE user_permissions;[39m
      [90mANALYZE file_metadatas;[39m
      [90mANALYZE sub_category_topics;[39m
      [90mANALYZE role_permissions;[39m
      [90mANALYZE institutions;[39m
      [90mANALYZE user_otps;[39m
      [90mANALYZE permissions;[39m
      [90mANALYZE evidence_reports;[39m
      [90mANALYZE audit_logs;[39m
      [90mANALYZE user_relationships;[39m
      [90mANALYZE _prisma_migrations;[39m
      [90mANALYZE user_recommendations;[39m
      [90mANALYZE topics;[39m
      [90mANALYZE sub_categories;[39m
      [90mANALYZE user_reports;[39m
      [90mANALYZE broadcast_latest_votes;[39m
      [90mANALYZE broadcast_likes;[39m


🔧 [1mMAINTENANCE SCHEDULE[22m
────────────────────────────────────────────────────────────────


[31m●[39m [1mVACUUM ANALYZE[22m [WEEKLY]
   📝 Update table statistics and reclaim space
   🔧 [90mVACUUM ANALYZE;[39m

[33m●[39m [1mREINDEX[22m [MONTHLY]
   📝 Rebuild indexes to maintain performance
   🔧 [90mREINDEX DATABASE your_database;[39m

[31m●[39m [1mCheck slow queries[22m [WEEKLY]
   📝 Monitor and optimize slow-running queries

[31m[1m●[22m[39m [1mBackup verification[22m [DAILY]
   📝 Ensure database backups are working correctly


📋 [1mAUDIT SUMMARY[22m
────────────────────────────────────────────────────────────────

📊 Overall Health Score: [31m3/10[39m
⚠️  Issues Found: [31m111[39m
💡 Recommendations: [33m3[39m
💰 Estimated Monthly Cost: $70.00

[33m⚡ Consider implementing the recommendations above to improve database health.[39m

────────────────────────────────────────────────────────────────
Report generated by SQL Optimizer v1.0
2025-08-05T14:49:26.488Z
